<!-- src/app/admin/pages/quiz/ui/email-template-editor/email-template-editor.component.html -->

<div class="email-editor-container" *ngIf="config$ | async as config">


  <!-- Tabs -->
  <div class="tabs tabs-boxed bg-base-200 mb-4">
    <a class="tab" 
       [class.tab-active]="activeSection === 'content'"
       (click)="setActiveSection('content')">
      üìù –ö–æ–Ω—Ç–µ–Ω—Ç
    </a>
    <a class="tab" 
       [class.tab-active]="activeSection === 'colors'"
       (click)="setActiveSection('colors')">
      üé® –¶–≤–µ—Ç–∞
    </a>
    <a class="tab" 
       [class.tab-active]="activeSection === 'advanced'"
       (click)="setActiveSection('advanced')">
      ‚öôÔ∏è –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ
    </a>
  </div>

  <!-- Content Section -->
  <div *ngIf="activeSection === 'content'" class="space-y-4">
    
    <!-- Subject (–¢–µ–º–∞ –ø–∏—Å—å–º–∞) - –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º–æ -->
    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">üìß –¢–µ–º–∞ –ø–∏—Å—å–º–∞ (Subject)</span>
        <span class="label-text-alt text-info" ngNonBindable>{{name}}, {{score}}</span>
      </label>
      <input type="text" 
             [value]="config.subject"
             (input)="updateConfig('subject', $any($event.target).value)"
             class="input input-bordered w-full input-primary"
             [placeholder]="subjectPlaceholder" />
    </div>

    <div class="divider"></div>

    <!-- Logo URL - –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º–æ -->
    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">URL –ª–æ–≥–æ—Ç–∏–ø–∞</span>
      </label>
      <input type="url" 
             [value]="config.logoUrl"
             (input)="updateConfig('logoUrl', $any($event.target).value)"
             class="input input-bordered w-full"
             placeholder="https://..." />
    </div>

    <!-- Greeting - –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º–æ -->
    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ</span>
        <span class="label-text-alt text-info" ngNonBindable>–î–æ–±–∞–≤–∏—Ç—Å—è ", {{name}}!"</span>
      </label>
      <input type="text" 
             [value]="config.greeting"
             (input)="updateConfig('greeting', $any($event.target).value)"
             class="input input-bordered w-full"
             placeholder="Xin ch√†o" />
    </div>

    <!-- Title - –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º–æ -->
    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤ —à–∞–ø–∫–µ</span>
      </label>
      <input type="text" 
             [value]="config.titleText"
             (input)="updateConfig('titleText', $any($event.target).value)"
             class="input input-bordered w-full"
             placeholder="Ch√∫c m·ª´ng b·∫°n!" />
    </div>

    <!-- ===================== TOGGLEABLE BLOCKS ===================== -->

    <!-- Highlight Block (–ë–∞–ª–ª—ã) -->
    <div class="card bg-base-200 p-4">
      <div class="flex items-center justify-between mb-3">
        <span class="font-medium">üìä –ë–ª–æ–∫ —Å –±–∞–ª–ª–∞–º–∏</span>
        <label class="label cursor-pointer gap-2">
          <span class="label-text text-sm">{{ config.showHighlight ? '–í–∫–ª' : '–í—ã–∫–ª' }}</span>
          <input type="checkbox" 
                 [checked]="config.showHighlight"
                 (change)="toggleBlock('showHighlight')"
                 class="toggle toggle-success toggle-sm" />
        </label>
      </div>
      <div [class.opacity-50]="!config.showHighlight" [class.pointer-events-none]="!config.showHighlight">
        <div class="form-control">
          <label class="label">
            <span class="label-text text-sm">–¢–µ–∫—Å—Ç –ø–æ–¥ –±–∞–ª–ª–∞–º–∏</span>
            <span class="label-text-alt text-info text-xs" ngNonBindable>{{score}} = –±–∞–ª–ª—ã</span>
          </label>
          <textarea 
                 [value]="config.highlightText"
                 (input)="updateConfig('highlightText', $any($event.target).value)"
                 class="textarea textarea-bordered w-full h-16 text-sm"
                 [placeholder]="scorePlaceholder"></textarea>
        </div>
      </div>
    </div>

    <!-- Prize Block -->
    <div class="card bg-base-200 p-4">
      <div class="flex items-center justify-between mb-3">
        <span class="font-medium">üéÅ –ë–ª–æ–∫ —Å –ø—Ä–∏–∑–æ–º</span>
        <label class="label cursor-pointer gap-2">
          <span class="label-text text-sm">{{ config.showPrize ? '–í–∫–ª' : '–í—ã–∫–ª' }}</span>
          <input type="checkbox" 
                 [checked]="config.showPrize"
                 (change)="toggleBlock('showPrize')"
                 class="toggle toggle-warning toggle-sm" />
        </label>
      </div>
      <div [class.opacity-50]="!config.showPrize" [class.pointer-events-none]="!config.showPrize">
        <div class="form-control">
          <label class="label">
            <span class="label-text text-sm">–¢–µ–∫—Å—Ç –æ –ø—Ä–∏–∑–µ</span>
          </label>
          <textarea 
                 [value]="config.prizeText"
                 (input)="updateConfig('prizeText', $any($event.target).value)"
                 class="textarea textarea-bordered w-full h-16 text-sm"
                 placeholder="B·∫°n nh·∫≠n ƒë∆∞·ª£c ph·∫ßn th∆∞·ªüng ƒë·∫∑c bi·ªát!"></textarea>
        </div>
      </div>
    </div>

    <!-- Description Block -->
    <div class="card bg-base-200 p-4">
      <div class="flex items-center justify-between mb-3">
        <span class="font-medium">üìù –ë–ª–æ–∫ –æ–ø–∏—Å–∞–Ω–∏—è</span>
        <label class="label cursor-pointer gap-2">
          <span class="label-text text-sm">{{ config.showDescription ? '–í–∫–ª' : '–í—ã–∫–ª' }}</span>
          <input type="checkbox" 
                 [checked]="config.showDescription"
                 (change)="toggleBlock('showDescription')"
                 class="toggle toggle-info toggle-sm" />
        </label>
      </div>
      <div [class.opacity-50]="!config.showDescription" [class.pointer-events-none]="!config.showDescription">
        <div class="form-control">
          <label class="label">
            <span class="label-text text-sm">–û–ø–∏—Å–∞–Ω–∏–µ</span>
          </label>
          <textarea 
                 [value]="config.descriptionText"
                 (input)="updateConfig('descriptionText', $any($event.target).value)"
                 class="textarea textarea-bordered w-full h-20 text-sm"
                 placeholder="C·∫£m ∆°n b·∫°n ƒë√£ tham gia..."></textarea>
        </div>
      </div>
    </div>

    <!-- CTA Block -->
    <div class="card bg-base-200 p-4">
      <div class="flex items-center justify-between mb-3">
        <span class="font-medium">üì¢ –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é</span>
        <label class="label cursor-pointer gap-2">
          <span class="label-text text-sm">{{ config.showCTA ? '–í–∫–ª' : '–í—ã–∫–ª' }}</span>
          <input type="checkbox" 
                 [checked]="config.showCTA"
                 (change)="toggleBlock('showCTA')"
                 class="toggle toggle-accent toggle-sm" />
        </label>
      </div>
      <div [class.opacity-50]="!config.showCTA" [class.pointer-events-none]="!config.showCTA">
        <div class="form-control">
          <label class="label">
            <span class="label-text text-sm">–¢–µ–∫—Å—Ç –ø—Ä–∏–∑—ã–≤–∞</span>
          </label>
          <input type="text" 
                 [value]="config.callToAction"
                 (input)="updateConfig('callToAction', $any($event.target).value)"
                 class="input input-bordered input-sm w-full"
                 placeholder="Nh·∫≠n ph·∫ßn th∆∞·ªüng c·ªßa b·∫°n ngay!" />
        </div>
      </div>
    </div>

    <!-- Button Block -->
    <div class="card bg-base-200 p-4">
      <div class="flex items-center justify-between mb-3">
        <span class="font-medium">üîò –ö–Ω–æ–ø–∫–∞</span>
        <label class="label cursor-pointer gap-2">
          <span class="label-text text-sm">{{ config.showButton ? '–í–∫–ª' : '–í—ã–∫–ª' }}</span>
          <input type="checkbox" 
                 [checked]="config.showButton"
                 (change)="toggleBlock('showButton')"
                 class="toggle toggle-primary toggle-sm" />
        </label>
      </div>
      <div [class.opacity-50]="!config.showButton" [class.pointer-events-none]="!config.showButton">
        <div class="grid grid-cols-2 gap-3">
          <div class="form-control">
            <label class="label">
              <span class="label-text text-sm">–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏</span>
            </label>
            <input type="text" 
                   [value]="config.btnText"
                   (input)="updateConfig('btnText', $any($event.target).value)"
                   class="input input-bordered input-sm w-full"
                   placeholder="Nh·∫≠n th∆∞·ªüng" />
          </div>
          <div class="form-control">
            <label class="label">
              <span class="label-text text-sm">–°—Å—ã–ª–∫–∞</span>
            </label>
            <input type="url" 
                   [value]="config.btnLink"
                   (input)="updateConfig('btnLink', $any($event.target).value)"
                   class="input input-bordered input-sm w-full"
                   placeholder="https://..." />
          </div>
        </div>
      </div>
    </div>

    <!-- Footer - –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º–æ -->
    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–¢–µ–∫—Å—Ç —Ñ—É—Ç–µ—Ä–∞</span>
      </label>
      <textarea 
             [value]="config.footerText"
             (input)="updateConfig('footerText', $any($event.target).value)"
             class="textarea textarea-bordered w-full h-16"
             placeholder="C·∫£m ∆°n b·∫°n ƒë√£ tham gia!"></textarea>
    </div>
  </div>

  <!-- Colors Section -->
  <div *ngIf="activeSection === 'colors'" class="space-y-6">
        <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üîù –®–∞–ø–∫–∞ (–≥—Ä–∞–¥–∏–µ–Ω—Ç)</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ù–∞—á–∞–ª–æ</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.headerBgStart" (input)="updateColor('headerBgStart', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.headerBgStart }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ö–æ–Ω–µ—Ü</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.headerBgEnd" (input)="updateColor('headerBgEnd', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.headerBgEnd }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üé® –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞</h4>
      <div class="grid grid-cols-3 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–û—Å–Ω–æ–≤–Ω–æ–π</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.primaryColor" (input)="updateColor('primaryColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.primaryColor }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–í—Ç–æ—Ä–∏—á–Ω—ã–π</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.secondaryColor" (input)="updateColor('secondaryColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.secondaryColor }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ê–∫—Ü–µ–Ω—Ç</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.accentColor" (input)="updateColor('accentColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.accentColor }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üìù –¶–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.textColor" (input)="updateColor('textColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.textColor }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–í—Ç–æ—Ä–∏—á–Ω—ã–π —Ç–µ–∫—Å—Ç</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.textSecondaryColor" (input)="updateColor('textSecondaryColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.textSecondaryColor }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üîò –ö–Ω–æ–ø–∫–∞ (–≥—Ä–∞–¥–∏–µ–Ω—Ç)</h4>
      <div class="grid grid-cols-3 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ù–∞—á–∞–ª–æ</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.btnBgStart" (input)="updateColor('btnBgStart', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.btnBgStart }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ö–æ–Ω–µ—Ü</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.btnBgEnd" (input)="updateColor('btnBgEnd', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.btnBgEnd }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–¢–µ–∫—Å—Ç</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.btnTextColor" (input)="updateColor('btnTextColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.btnTextColor }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üñºÔ∏è –§–æ–Ω</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–Ω</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.bgColor" (input)="updateColor('bgColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.bgColor }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–§–æ–Ω –∫–∞—Ä—Ç–æ—á–∫–∏</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.cardBgColor" (input)="updateColor('cardBgColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.cardBgColor }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Advanced Section -->
  <div *ngIf="activeSection === 'advanced'" class="space-y-4">
    
    <!-- <div class="alert alert-info">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <div>
        <h3 class="font-bold">–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:</h3>
        <p class="text-sm" ngNonBindable>
          <code class="bg-base-300 px-1 rounded">{{name}}</code> ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br>
          <code class="bg-base-300 px-1 rounded">{{score}}</code> ‚Äî –±–∞–ª–ª—ã (%)<br>
          <code class="bg-base-300 px-1 rounded">{{quizTitle}}</code> ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–≤–∏–∑–∞<br>
          <code class="bg-base-300 px-1 rounded">{{correct}}</code> ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤<br>
          <code class="bg-base-300 px-1 rounded">{{total}}</code> ‚Äî –≤—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤<br>
          <code class="bg-base-300 px-1 rounded">{{year}}</code> ‚Äî —Ç–µ–∫—É—â–∏–π –≥–æ–¥
        </p>
      </div>
    </div> -->

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4">üîç –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–≤—å—é</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ò–º—è</span></label>
          <input type="text" [(ngModel)]="previewVariables.name" class="input input-bordered input-sm w-full" />
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ë–∞–ª–ª—ã</span></label>
          <input type="number" [(ngModel)]="previewVariables.score" class="input input-bordered input-sm w-full" />
        </div>
      </div>
    </div>

    <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –±–ª–æ–∫–∞–º–∏ -->
    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4">‚ö° –ë—ã—Å—Ç—Ä–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏</h4>
      <div class="flex flex-wrap gap-2">
        <button class="btn btn-sm" 
                [class.btn-success]="config.showHighlight"
                [class.btn-ghost]="!config.showHighlight"
                (click)="toggleBlock('showHighlight')">
          üìä –ë–∞–ª–ª—ã
        </button>
        <button class="btn btn-sm" 
                [class.btn-warning]="config.showPrize"
                [class.btn-ghost]="!config.showPrize"
                (click)="toggleBlock('showPrize')">
          üéÅ –ü—Ä–∏–∑
        </button>
        <button class="btn btn-sm" 
                [class.btn-info]="config.showDescription"
                [class.btn-ghost]="!config.showDescription"
                (click)="toggleBlock('showDescription')">
          üìù –û–ø–∏—Å–∞–Ω–∏–µ
        </button>
        <button class="btn btn-sm" 
                [class.btn-accent]="config.showCTA"
                [class.btn-ghost]="!config.showCTA"
                (click)="toggleBlock('showCTA')">
          üì¢ CTA
        </button>
        <button class="btn btn-sm" 
                [class.btn-primary]="config.showButton"
                [class.btn-ghost]="!config.showButton"
                (click)="toggleBlock('showButton')">
          üîò –ö–Ω–æ–ø–∫–∞
        </button>
      </div>
    </div>

    <div class="flex justify-center mt-6">
      <button class="btn btn-outline btn-error gap-2" (click)="resetToDefault()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
          <path d="M3 3v5h5"/>
        </svg>
        –°–±—Ä–æ—Å–∏—Ç—å –∫ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º
      </button>
    </div>
  </div>
</div>