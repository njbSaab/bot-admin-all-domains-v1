<!-- src/app/admin/pages/quiz/components/email-template-editor/email-template-editor.component.html -->

<div class="email-editor-container" *ngIf="config$ | async as config">
  
  <!-- Info –¥–ª—è edit —Ä–µ–∂–∏–º–∞ -->
  <div class="alert alert-info mb-4" *ngIf="mode === 'edit'">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
    </svg>
    <span>–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç–µ —à–∞–±–ª–æ–Ω –¥–ª—è —ç—Ç–æ–≥–æ –∫–≤–∏–∑–∞. –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π HTML.</span>
  </div>

  <!-- Tabs -->
  <div class="tabs tabs-boxed bg-base-200 mb-4">
    <a class="tab" 
       [class.tab-active]="activeSection === 'content'"
       (click)="setActiveSection('content')">
      üìù –ö–æ–Ω—Ç–µ–Ω—Ç
    </a>
    <a class="tab" 
       [class.tab-active]="activeSection === 'colors'"
       (click)="setActiveSection('colors')">
      üé® –¶–≤–µ—Ç–∞
    </a>
    <a class="tab" 
       [class.tab-active]="activeSection === 'advanced'"
       (click)="setActiveSection('advanced')">
      ‚öôÔ∏è –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ
    </a>
  </div>

  <!-- Content Section -->
  <div *ngIf="activeSection === 'content'" class="space-y-4">
    
    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">URL –ª–æ–≥–æ—Ç–∏–ø–∞</span>
      </label>
      <input type="url" 
             [value]="config.logoUrl"
             (input)="updateConfig('logoUrl', $any($event.target).value)"
             class="input input-bordered w-full"
             placeholder="https://..." />
    </div>

    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ</span>
        <span class="label-text-alt text-info" ngNonBindable>–î–æ–±–∞–≤–∏—Ç—Å—è ", {{name}}!"</span>
      </label>
      <input type="text" 
             [value]="config.greeting"
             (input)="updateConfig('greeting', $any($event.target).value)"
             class="input input-bordered w-full"
             placeholder="Xin ch√†o" />
    </div>

    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤ —à–∞–ø–∫–µ</span>
      </label>
      <input type="text" 
             [value]="config.titleText"
             (input)="updateConfig('titleText', $any($event.target).value)"
             class="input input-bordered w-full"
             placeholder="Ch√∫c m·ª´ng b·∫°n!" />
    </div>

    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–¢–µ–∫—Å—Ç –ø–æ–¥ –±–∞–ª–ª–∞–º–∏</span>
        <span class="label-text-alt text-info" ngNonBindable>{{score}} = –±–∞–ª–ª—ã</span>
      </label>
      <textarea 
             [value]="config.highlightText"
             (input)="updateConfig('highlightText', $any($event.target).value)"
             class="textarea textarea-bordered w-full h-20"
             placeholder="S·ªë c√¢u ƒë√∫ng: X / Y"></textarea>
    </div>

    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–¢–µ–∫—Å—Ç –æ –ø—Ä–∏–∑–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
      </label>
      <textarea 
             [value]="config.prizeText"
             (input)="updateConfig('prizeText', $any($event.target).value)"
             class="textarea textarea-bordered w-full h-20"
             placeholder="B·∫°n nh·∫≠n ƒë∆∞·ª£c ph·∫ßn th∆∞·ªüng ƒë·∫∑c bi·ªát!"></textarea>
    </div>

    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–û–ø–∏—Å–∞–Ω–∏–µ</span>
      </label>
      <textarea 
             [value]="config.descriptionText"
             (input)="updateConfig('descriptionText', $any($event.target).value)"
             class="textarea textarea-bordered w-full h-24"
             placeholder="C·∫£m ∆°n b·∫°n ƒë√£ tham gia..."></textarea>
    </div>

    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é</span>
      </label>
      <input type="text" 
             [value]="config.callToAction"
             (input)="updateConfig('callToAction', $any($event.target).value)"
             class="input input-bordered w-full"
             placeholder="Nh·∫≠n ph·∫ßn th∆∞·ªüng c·ªßa b·∫°n ngay!" />
    </div>

    <div class="grid grid-cols-2 gap-4">
      <div class="form-control">
        <label class="label">
          <span class="label-text font-medium">–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏</span>
        </label>
        <input type="text" 
               [value]="config.btnText"
               (input)="updateConfig('btnText', $any($event.target).value)"
               class="input input-bordered w-full"
               placeholder="Nh·∫≠n ph·∫ßn th∆∞·ªüng" />
      </div>
      <div class="form-control">
        <label class="label">
          <span class="label-text font-medium">–°—Å—ã–ª–∫–∞ –∫–Ω–æ–ø–∫–∏</span>
        </label>
        <input type="url" 
               [value]="config.btnLink"
               (input)="updateConfig('btnLink', $any($event.target).value)"
               class="input input-bordered w-full"
               placeholder="https://..." />
      </div>
    </div>

    <div class="form-control">
      <label class="label">
        <span class="label-text font-medium">–¢–µ–∫—Å—Ç —Ñ—É—Ç–µ—Ä–∞</span>
      </label>
      <textarea 
             [value]="config.footerText"
             (input)="updateConfig('footerText', $any($event.target).value)"
             class="textarea textarea-bordered w-full h-20"
             placeholder="C·∫£m ∆°n b·∫°n ƒë√£ tham gia!"></textarea>
    </div>
  </div>

  <!-- Colors Section -->
  <div *ngIf="activeSection === 'colors'" class="space-y-6">
    
    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üé® –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞</h4>
      <div class="grid grid-cols-3 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–û—Å–Ω–æ–≤–Ω–æ–π</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.primaryColor" (input)="updateColor('primaryColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.primaryColor }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–í—Ç–æ—Ä–∏—á–Ω—ã–π</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.secondaryColor" (input)="updateColor('secondaryColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.secondaryColor }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ê–∫—Ü–µ–Ω—Ç</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.accentColor" (input)="updateColor('accentColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.accentColor }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üìù –¶–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.textColor" (input)="updateColor('textColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.textColor }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–í—Ç–æ—Ä–∏—á–Ω—ã–π —Ç–µ–∫—Å—Ç</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.textSecondaryColor" (input)="updateColor('textSecondaryColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.textSecondaryColor }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üîù –®–∞–ø–∫–∞ (–≥—Ä–∞–¥–∏–µ–Ω—Ç)</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ù–∞—á–∞–ª–æ</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.headerBgStart" (input)="updateColor('headerBgStart', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.headerBgStart }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ö–æ–Ω–µ—Ü</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.headerBgEnd" (input)="updateColor('headerBgEnd', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.headerBgEnd }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üîò –ö–Ω–æ–ø–∫–∞ (–≥—Ä–∞–¥–∏–µ–Ω—Ç)</h4>
      <div class="grid grid-cols-3 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ù–∞—á–∞–ª–æ</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.btnBgStart" (input)="updateColor('btnBgStart', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.btnBgStart }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ö–æ–Ω–µ—Ü</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.btnBgEnd" (input)="updateColor('btnBgEnd', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.btnBgEnd }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–¢–µ–∫—Å—Ç</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.btnTextColor" (input)="updateColor('btnTextColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.btnTextColor }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4 text-primary">üñºÔ∏è –§–æ–Ω</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–Ω</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.bgColor" (input)="updateColor('bgColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.bgColor }}</span>
          </div>
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–§–æ–Ω –∫–∞—Ä—Ç–æ—á–∫–∏</span></label>
          <div class="flex items-center gap-2">
            <input type="color" [value]="config.cardBgColor" (input)="updateColor('cardBgColor', $event)" class="w-10 h-10 rounded cursor-pointer border" />
            <span class="text-xs font-mono">{{ config.cardBgColor }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Advanced Section -->
  <div *ngIf="activeSection === 'advanced'" class="space-y-4">
    
    <div class="alert alert-info">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <div>
        <h3 class="font-bold">–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:</h3>
        <p class="text-sm" ngNonBindable>
          <code class="bg-base-300 px-1 rounded">{{name}}</code> ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br>
          <code class="bg-base-300 px-1 rounded">{{score}}</code> ‚Äî –±–∞–ª–ª—ã (%)<br>
          <code class="bg-base-300 px-1 rounded">{{quizTitle}}</code> ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–≤–∏–∑–∞<br>
          <code class="bg-base-300 px-1 rounded">{{year}}</code> ‚Äî —Ç–µ–∫—É—â–∏–π –≥–æ–¥
        </p>
      </div>
    </div>

    <div class="card bg-base-200 p-4">
      <h4 class="font-bold mb-4">üîç –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–≤—å—é</h4>
      <div class="grid grid-cols-2 gap-4">
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ò–º—è</span></label>
          <input type="text" [(ngModel)]="previewVariables.name" class="input input-bordered input-sm w-full" />
        </div>
        <div class="form-control">
          <label class="label"><span class="label-text text-sm">–ë–∞–ª–ª—ã</span></label>
          <input type="number" [(ngModel)]="previewVariables.score" class="input input-bordered input-sm w-full" />
        </div>
      </div>
    </div>

    <div class="flex justify-center mt-6">
      <button class="btn btn-outline btn-error gap-2" (click)="resetToDefault()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
          <path d="M3 3v5h5"/>
        </svg>
        –°–±—Ä–æ—Å–∏—Ç—å –∫ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º
      </button>
    </div>
  </div>
</div>